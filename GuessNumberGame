/*
The program is to let user or the computer play a guessing game. The computer randomly picks
a number in between 1 and 100, and then for each guess the user or computer makes, the computer
informs the user whether the guess was too high or too low. The program should start a new guessing
game when the correct number is selected to end this run.
Note. 
1.Put main function head.
2.Computer should get right number by binary search.
eg.
Would you like to (p)lay or watch the (c)omputer play?
p
Enter your guess in between 1 and 100.
45
Sorry, your guess is too high, try again.
Enter your guess in between 1 and 100.
...
Congrats, you guessed the correct number, 30.

Would you like to (p)lay or watch the (c)omputer play or (q)uit?
c
The computer's guess is 50.
Sorry, your guess is too high, try again.
The computer's guess is 25.
Sorry, your guess is too high, try again.
The computer's guess is 13.
Sorry, your guess is too low, try again.
The computer's guess is 19.
Sorry, your guess is too high, try again.
The computer's guess is 16.
Sorry, your guess is too low, try again.
The computer's guess is 17.
Congrats, you guessed the correct number, 17.

Would you like to (p)lay or watch the (c)omputer play or (q)uit?
q
*/

#include<iostream>
#include<algorithm>
#include<cstdlib>
#include<ctime>

using namespace std;

const int C = 100;

string WordsToPlayer = "";
string IsPlay = "";

bool IsEnd = false;

int GuessNum = 0;
int num = 0;
int result = -1;

void Init();
void SetWordsToPlayer();
void ComputerBinarySearch(int goal);
void PlayerSearch();
void PlayGame();

int main()
{
	  WordsToPlayer = "Would you like to (p)lay or watch the (c)omputer play?";
	  IsEnd = false;
	  while(!IsEnd){
		   Init();
		   PlayGame();
		   SetWordsToPlayer();
    }
    return 0;
}

void Init()
{
	  srand(unsigned(time(NULL)));
	  num = ( rand() % C) + 1;
}

void SetWordsToPlayer()
{
  	WordsToPlayer = "Would you like to (p)lay or watch the (c)omputer play or (q)uit?";
}

void ComputerBinarySearch(int goal)
{  
    int low = 1;
    int high = 100;
    int middle = (high + low) / 2; 
    while (low <= high){
		    //middle = (high - low) / 2 + low;
        middle = (high + low) / 2; 
        if (middle == goal){
			      cout<<"The computer's guess is "<<middle<<"."<<endl;
        	  cout<<"Congrats, you guessed the correct number, "<<num<<"."<<endl;
			      cout<<endl;
            break;
        }
        else if (middle > goal){
			      //high = middle - 1;
            high = middle;
            cout<<"The computer's guess is "<<middle<<"."<<endl;
            cout<<"Sorry, your guess is too high, try again."<<endl;
        }
        else{	 
		        //low = middle + 1;
            low = middle;
            cout<<"The computer's guess is "<<middle<<"."<<endl;
            cout<<"Sorry, your guess is too low, try again."<<endl;
        }
    }
}

void PlayerSearch()
{
	  while(true){
		    cout<<"Enter your guess in between 1 and 100."<<endl;
		    cin>>GuessNum;
		    while(GuessNum < 1 || GuessNum > 100){
		    	 cout<<"Please enter your guess in between 1 and 100."<<endl;
		        cin>>GuessNum;
			  }
		    if(GuessNum > num){
		        cout<<"Sorry, your guess is too high, try again."<<endl;
			  }
			  else if(GuessNum < num){
				    cout<<"Sorry, your guess is too low, try again."<<endl;
			  }
			  else{
				    cout<<"Congrats, you guessed the correct number, "<<num<<"."<<endl;
				    cout<<endl;
				    break;
			  }
	   }
}

void PlayGame()
{
	  cout<<WordsToPlayer<<endl;
	  cin>>IsPlay;
	  if(IsPlay == "p"){
	      PlayerSearch();
	  }
	  else if(IsPlay == "c"){
		    ComputerBinarySearch(num);
	  }
	  else if(IsPlay == "q"){
		    IsEnd = true;
	  }
	  else{
		    cout<<"Please input in right format."<<endl;
	  }
}
